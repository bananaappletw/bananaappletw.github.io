<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-archives">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Blog | bananaappletw&#x27;s blog</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://bananaappletw.github.io/img/profile.jpg"><meta data-rh="true" name="twitter:image" content="https://bananaappletw.github.io/img/profile.jpg"><meta data-rh="true" property="og:url" content="https://bananaappletw.github.io/archives/page/2"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" property="og:title" content="Blog | bananaappletw&#x27;s blog"><meta data-rh="true" name="description" content="Blog"><meta data-rh="true" property="og:description" content="Blog"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://bananaappletw.github.io/archives/page/2"><link data-rh="true" rel="alternate" href="https://bananaappletw.github.io/archives/page/2" hreflang="en"><link data-rh="true" rel="alternate" href="https://bananaappletw.github.io/archives/page/2" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="bananaappletw&#39;s blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="bananaappletw&#39;s blog Atom Feed">




<link rel="alternate" type="application/rss+xml" href="/archives/rss.xml" title="bananaappletw&#39;s blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/archives/atom.xml" title="bananaappletw&#39;s blog Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/treasure/rss.xml" title="bananaappletw&#39;s blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/treasure/atom.xml" title="bananaappletw&#39;s blog Atom Feed"><link rel="stylesheet" href="/assets/css/styles.db6f7c00.css">
<link rel="preload" href="/assets/js/runtime~main.eacc079a.js" as="script">
<link rel="preload" href="/assets/js/main.3611ed56.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/profile.jpg" alt="My Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/profile.jpg" alt="My Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">bananaappletw&#x27;s blog</b></a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/archive">Archive</a><a class="navbar__item navbar__link" href="/treasure">Treasure</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/bananaappletw/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archives/official-website-review">Official website review</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archives/welcome">Welcome</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archives/review-of-bamboofox-platform">Review of bamboofox platform</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archives/Rails-on-Ubuntu">Rails on Ubuntu</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/archives/Rails-Best-practice">Rails best practices</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/archives/Virtualization">Virtualization</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2016-11-18T15:07:00.000Z" itemprop="datePublished">November 18, 2016</time> · <!-- -->3 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><span itemprop="name">bananaapple</span></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>紀錄一下自己最近研讀虛擬化技術的筆記</p><p>因為最近要寫有關 qemu 的東西順便學習一下</p><p>在介紹之前讓我們先了解一下一些名詞</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hypervisor--virtual-machine-monitor-">Hypervisor ( virtual machine monitor )<a href="#hypervisor--virtual-machine-monitor-" class="hash-link" aria-label="Direct link to Hypervisor ( virtual machine monitor )" title="Direct link to Hypervisor ( virtual machine monitor )">​</a></h2><p>用來管理和執行 virtual machine 的軟體</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="host-machine">Host machine<a href="#host-machine" class="hash-link" aria-label="Direct link to Host machine" title="Direct link to Host machine">​</a></h2><p>用來執行 hypervisor 的機器</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="guest-machine">Guest machine<a href="#guest-machine" class="hash-link" aria-label="Direct link to Guest machine" title="Direct link to Guest machine">​</a></h2><p>被 hypervisor 管理的機器</p><p>比如說你在你的電腦上使用 Virtual Box 開了兩個虛擬機，一個是 Windows 10，一個是 Ubuntu</p><p>那 Virtual Box 就是 hypervisor，你的電腦就是 Host machine，而 Windows 10 和 Ubuntu 就是 Guest machine</p><p>我們通常會將 Guest machine 稱為 instance，instance 可以是不同的作業系統</p><p>那跟這個對比的就是 Operating-system-level virtualization，在這通常會將 Guest machine 稱作是 container，container 只能是同一種的作業系統，但是 user space 可以不一樣，像是不同的 Linux distribution 用的是同一個 kernel</p><p>那現在正式開始介紹 hypervisor 的類型</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hypervisor-type">Hypervisor Type<a href="#hypervisor-type" class="hash-link" aria-label="Direct link to Hypervisor Type" title="Direct link to Hypervisor Type">​</a></h2><p><img loading="lazy" src="https://upload.wikimedia.org/wikipedia/commons/e/e1/Hyperviseur.png" class="img_ev3q"></p><ul><li>Type-1, native or bare-metal hypervisor</li></ul><p>這種類型的 hypervisor 可以在硬體上執行</p><p>Citrix XenServer, Microsoft Hyper-V and VMware ESX/ESXi 屬於這種</p><ul><li>Type-2 or hosted hypervisors</li></ul><p>Hypervisor 被當成 Host machine 的一隻 process 執行</p><p>VMware Workstation, VMware Player, VirtualBox, Parallels Desktop for Mac and QEMU 屬於這種</p><p>現在 Type-1 和 Type-2 兩者之間的界線越來越模糊，因為原本是 Type-2 的 virtual machine 鑒於效能考量紛紛跨入 Type-1，像是 Linux 的 KVM 就可以被歸類在兩種不同的 hypervisor</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="virtual-machine">Virtual machine<a href="#virtual-machine" class="hash-link" aria-label="Direct link to Virtual machine" title="Direct link to Virtual machine">​</a></h2><p>我們所謂的 virtual machine 主要分為以下三種</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="virtual-machine-type">Virtual machine type<a href="#virtual-machine-type" class="hash-link" aria-label="Direct link to Virtual machine type" title="Direct link to Virtual machine type">​</a></h2><ul><li>System virtual machines ( Full virtualization )</li><li>Hardware-assisted virtualization</li><li>Operating-system-level virtualization</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="system-virtual-machines--full-virtualization-">System virtual machines ( Full virtualization )<a href="#system-virtual-machines--full-virtualization-" class="hash-link" aria-label="Direct link to System virtual machines ( Full virtualization )" title="Direct link to System virtual machines ( Full virtualization )">​</a></h2><p>提供了虛擬化整個作業系統的功能</p><p>Parallels Workstation, Parallels Desktop for Mac, VirtualBox, Virtual Iron, Oracle VM, Virtual PC, Virtual Server, Hyper-V, VMware Workstation, VMware Server (discontinued, formerly called GSX Server), VMware ESXi, QEMU, Adeos, Mac-on-Linux</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hardware-assisted-virtualization">Hardware-assisted virtualization<a href="#hardware-assisted-virtualization" class="hash-link" aria-label="Direct link to Hardware-assisted virtualization" title="Direct link to Hardware-assisted virtualization">​</a></h2><p>透過硬體的支援，使得效率提高</p><p>KVM, VMware Workstation, VMware Fusion, Hyper-V, Windows Virtual PC, Xen, Parallels Desktop for Mac, Oracle VM Server for SPARC, VirtualBox and Parallels Workstation</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="operating-system-level-virtualization">Operating-system-level virtualization<a href="#operating-system-level-virtualization" class="hash-link" aria-label="Direct link to Operating-system-level virtualization" title="Direct link to Operating-system-level virtualization">​</a></h2><p>這種技術是指 kernel 作業系統本身提供的虛擬化功能，像是 Linux container 簡稱為 LXC，Docker 在 0.9 版前其實就是 LXC 的前端</p><h1>Reference:</h1><ul><li><a href="https://en.wikipedia.org/wiki/Virtual_machine" target="_blank" rel="noopener noreferrer">Virtual machine wiki</a></li><li><a href="https://en.wikipedia.org/wiki/Hypervisor" target="_blank" rel="noopener noreferrer">Hypervisor wiki</a></li></ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/archives/tags/virtualization">virtualization</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/archives/Javascript-function-paramter-default-value">Javascript function paramter default  value</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2016-11-16T22:56:00.000Z" itemprop="datePublished">November 16, 2016</time> · <!-- -->One min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><span itemprop="name">bananaapple</span></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>function f(s)
{
var a = (s == undefined) ? &#x27;qq&#x27; : s;
}</p><p>Can be rewrited as following code</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">function f(s)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    var a = s || &#x27;qq&#x27;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>First statement will evaluate value of s is true or not.</p><p>If true, s is assigned to a.</p><p>Else, statement will find next value a.k.a. &#x27;qq&#x27;.</p><p>&#x27;qq&#x27; will be assigned to a.</p><p>For further, you could directly write code like this in ES6.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">function f(s = &#x27;qq&#x27;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/archives/tags/javascript">javascript</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/archives/My-favorite-script">My favorite script</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2016-06-10T20:35:00.000Z" itemprop="datePublished">June 10, 2016</time> · <!-- -->One min read</div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="format-code">Format code<a href="#format-code" class="hash-link" aria-label="Direct link to Format code" title="Direct link to Format code">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">astyle --style=allman --unpad-paren --pad-oper --convert-tabs --pad-header --delete-empty-lines [source_code_file]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Full document can be found here.</p><p><a href="http://astyle.sourceforge.net/astyle.html" target="_blank" rel="noopener noreferrer">http://astyle.sourceforge.net/astyle.html</a></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/archives/tags/script">script</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/archives/I-don-t-know-c-language">I don&#x27;t know c language</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2016-04-21T21:12:00.000Z" itemprop="datePublished">April 21, 2016</time> · <!-- -->2 min read</div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="allocate-string-by-array-or-pointer">allocate string by array or pointer<a href="#allocate-string-by-array-or-pointer" class="hash-link" aria-label="Direct link to allocate string by array or pointer" title="Direct link to allocate string by array or pointer">​</a></h2><p>What&#x27;s difference between them?</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include&lt;stdio.h&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int main()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    char a[] = &quot;apple&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    char *b = &quot;apple&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="answer">Answer<a href="#answer" class="hash-link" aria-label="Direct link to Answer" title="Direct link to Answer">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    char a[] = &quot;apple&quot;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When string is allocated by array, all the characters are saved in the stack.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    char *b = &quot;apple&quot;;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When string is allocated by pointer, only pointer is saved in the stack, and it points to the string, which is saved in the read-only section.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="function-argument-array-or-pointer">function argument array or pointer<a href="#function-argument-array-or-pointer" class="hash-link" aria-label="Direct link to function argument array or pointer" title="Direct link to function argument array or pointer">​</a></h2><p>What&#x27;s difference between them?</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include&lt;stdio.h&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void func1(char * s)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    printf(&quot;%s&quot;,s);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">void func2(char s[])</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    printf(&quot;%s&quot;,s);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">int main()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    func1(&quot;apple&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    func2(&quot;apple&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return 0;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In book &quot;The c programming language 2nd&quot;</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">As formal parameters in a function definition,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    char s[];</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">and</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    char *s;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">are equivalent; we prefer the latter because it says more explicitly that the</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">parameter is a pointer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>But in which situation, we prefer to use array argument?
In one mail to linux kernel mentioned that</p><p><a href="https://lkml.org/lkml/2015/9/3/499" target="_blank" rel="noopener noreferrer">https://lkml.org/lkml/2015/9/3/499</a></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">The &quot;array as function argument&quot; syntax is occasionally useful</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">(particularly for the multi-dimensional array case), so I very much</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">understand why it exists, I just think that in the kernel we&#x27;d be</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">better off with the rule that it&#x27;s against our coding practices.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sizeof-is-an-operator">sizeof is an operator<a href="#sizeof-is-an-operator" class="hash-link" aria-label="Direct link to sizeof is an operator" title="Direct link to sizeof is an operator">​</a></h2><p>sizeof value is determined in compile time.</p><p>sizeof is only correctly used in two places.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="array">array<a href="#array" class="hash-link" aria-label="Direct link to array" title="Direct link to array">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">char s[10];</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">printf(&quot;%zu&quot;,sizeof(s));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// 10</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="type">type<a href="#type" class="hash-link" aria-label="Direct link to type" title="Direct link to type">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">char* s=&quot;hello&quot;;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">printf(&quot;%zu&quot;,sizeof(s));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">printf(&quot;%zu&quot;,sizeof(char *));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// sizeof(variable) == sizeof(variable type)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><a href="https://en.wikipedia.org/wiki/Sizeof" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Sizeof</a></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/archives/tags/c">c</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/archives/alignment-and-round-number-using-and">alignment and round number using &amp; and ~</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2016-03-31T02:02:00.000Z" itemprop="datePublished">March 31, 2016</time> · <!-- -->One min read</div></header><div class="markdown" itemprop="articleBody"><p>While tracing malloc.c code, I found some interesting bitwise operation.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define MALLOC_ALIGN_MASK      (MALLOC_ALIGNMENT - 1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#define MINSIZE  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  (unsigned long)(((MIN_CHUNK_SIZE+MALLOC_ALIGN_MASK) &amp; ~MALLOC_ALIGN_MASK))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>I found the answer in the stackoverflow.</p><p><a href="http://stackoverflow.com/questions/14561402/how-is-this-size-alignment-working" target="_blank" rel="noopener noreferrer">http://stackoverflow.com/questions/14561402/how-is-this-size-alignment-working</a></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">All powers of two (1, 2, 4, 8, 16, 32...) can be aligned by simple a and operation.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">This gives the size rounded down:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">size &amp;= ~(alignment - 1); </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">or if you want to round up:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">size = (size + alignment-1) &amp; ~(alignment-1);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>MINSIZE</strong> macro trying to find largest number alignment to <strong>MALLOC_ALIGNMENT</strong></p><p>For example</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">MIN_CHUNK_SIZE = 25;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">MALLOC_ALIGNMENT = 8</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">MALLOC_ALIGN_MASK = 8-1 = 7;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">MINSIZE = (25+7) &amp; ~7 = 32;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>More</h1><p><a href="https://graphics.stanford.edu/%5C~seander/bithacks.html" target="_blank" rel="noopener noreferrer">https://graphics.stanford.edu/\~seander/bithacks.html</a></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/archives/tags/linux-kernel">linux kernel</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/archives/review">2016 review</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2016-03-22T13:48:00.000Z" itemprop="datePublished">March 22, 2016</time> · <!-- -->One min read</div></header><div class="markdown" itemprop="articleBody"><p>TODO list:</p><ul class="contains-task-list containsTaskList_mC6p"><li>[O]<!-- --> K&amp;R The C Programming Language (Second Edition)</li><li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Robert Love linux kernel development (Third Edition)</li><li>[O][sqlab website]<!-- -->(<a href="http://sqlab.github.io/" target="_blank" rel="noopener noreferrer">http://sqlab.github.io/</a>)</li></ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/archives/tags/review">review</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/archives/how-python-pass-argument-in-function">how python pass argument in function</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2016-03-22T13:47:00.000Z" itemprop="datePublished">March 22, 2016</time> · <!-- -->3 min read</div></header><div class="markdown" itemprop="articleBody"><p>網路上看到蠻多說法的像是
call by value vs call by reference
事實上 call by assignment 才是 python 傳遞參數的方式
主要要介紹 python 的 object
像是以下這行程式碼</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">a = 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>a 就是一個 reference 指向數值為 1 的 PyIntObject
就像是 c 裡面的指標指向一個變數一樣
繼續看一段程式碼</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">def fun(a):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    print id(a)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">a = 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print id(a)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fun(a)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">11211096</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">11211096</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;&quot;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>那這裡實際上內部是怎麼做的呢?
傳進去 fun function 裡的事實上是 copy of reference to PyIntObject
事實上和還沒傳進去的 a 是兩個不同的 reference 指向同一個 object
id 這個函式 return 的是 object 的位置
所以兩個的值才會一樣
要是有興趣可以看 cpython 裡 id function 的實作</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">static PyObject *</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">builtin_id(PyModuleDef *self, PyObject *v)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">/*[clinic end generated code: output=0aa640785f697f65 input=5a534136419631f4]*/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return PyLong_FromVoidPtr(v);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>我們修改一下程式碼</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">def fun(a):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    print id(a)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    a += 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    print id(a)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">a = 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print id(a)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fun(a)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print id(a)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">41632088</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">41632088</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">41632064</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">41632088</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;&quot;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>我們會發覺 id(a) 在 fun function 前後都不會變
這是因為傳進去 function 裡的是 copy of reference to object
所以不會影響到原本的 reference
但是在 fun function 裡的 a
經過 +=1 後 id 改變了
這是因為 int 是 immutable type
當你要嘗試改 immutable type 的 variable 的時候
他會先產生一個新的 object 再將你的 reference 指向那個 object
要是是mutable variable呢?</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">def fun(a):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    print id(a)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    a.append(1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">a = []</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print id(a)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fun(a)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print id(a)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">140347177386784</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[1]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">140347177386784</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[1]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">140347177386784</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;&quot;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>執行後會發現 id 都不變
這是因為 mutable variable 的處理方式和 immutable 不同
他是將 reference 指到的 object 擴充而不是重新 assign 一個
那 mutable variable 的 assign 呢?</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">def fun(a):</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    print id(a)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    a.append(1)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">a = []</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print id(a)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fun(a)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print id(a)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">140318457238304</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[1]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">140318457251672</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">[]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">140318457238304</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">&quot;&quot;&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>這裡 mutable variable 就和 immutable variable 一樣了
直接捨棄了原本的 object 指向一個新的 object
所以原本傳進去的也是 copy of reference to object
原本的 a 不會受到影響</p><p>Reference:</p><ul><li><a href="https://docs.python.org/2/faq/programming.html#how-do-i-write-a-function-with-output-parameters-call-by-reference" target="_blank" rel="noopener noreferrer">call by assignment</a></li><li><a href="https://github.com/python/cpython/blob/master/Python%2Fbltinmodule.c#L1092" target="_blank" rel="noopener noreferrer">cpython</a></li></ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/archives/tags/python">python</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/archives/qira-introduction">qira introduction</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2016-03-22T13:42:00.000Z" itemprop="datePublished">March 22, 2016</time> · <!-- -->2 min read</div></header><div class="markdown" itemprop="articleBody"><p><img loading="lazy" src="http://qira.me/img/first_splash.png" alt="image from qira.me website" class="img_ev3q"></p><hr><ul><li>QIRA is timeless debugger</li><li>Fullname is QEMU Interactive Runtime Analyser</li><li>QIRA was initially developed at Google by George Hotz. Work continues at CMU.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="qira-website">qira website<a href="#qira-website" class="hash-link" aria-label="Direct link to qira website" title="Direct link to qira website">​</a></h2><p><a href="http://qira.me/" target="_blank" rel="noopener noreferrer">http://qira.me/</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="qira-github-repository">qira github repository<a href="#qira-github-repository" class="hash-link" aria-label="Direct link to qira github repository" title="Direct link to qira github repository">​</a></h2><p><a href="https://github.com/BinaryAnalysisPlatform/qira" target="_blank" rel="noopener noreferrer">https://github.com/BinaryAnalysisPlatform/qira</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="installation">Installation<a href="#installation" class="hash-link" aria-label="Direct link to Installation" title="Direct link to Installation">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd ~/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">git clone https://github.com/BinaryAnalysisPlatform/qira.git</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd qira/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">./install.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If you want to run with other architecture, run the following command</p><p>It will fetch other architecture&#x27;s library</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">./fetchlib.sh</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="usage">Usage<a href="#usage" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h2><p><img loading="lazy" src="http://i.imgur.com/N5EpyfB.png" alt="Usage" class="img_ev3q"></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd ~/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wget http://train.cs.nctu.edu.tw/files/magic</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chmod +x ./magic</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">qira  -s ./magic</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>open other terminal and type</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">nc 0 4000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>use this terminal to interactive with program</p><p>You could trace the instructions with web browser on http://localhost:3002/</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="keyboard-shortcuts-in-webclientcontrolsjs">Keyboard Shortcuts in web/client/controls.js<a href="#keyboard-shortcuts-in-webclientcontrolsjs" class="hash-link" aria-label="Direct link to Keyboard Shortcuts in web/client/controls.js" title="Direct link to Keyboard Shortcuts in web/client/controls.js">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">j -- next invocation of instruction</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">k -- prev invocation of instruction</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">shift-j -- next toucher of data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">shift-k -- prev toucher of data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">m -- go to return from current function</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">, -- go to start of current function</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">z -- zoom out max on vtimeline</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">l -- set iaddr to instruction at current clnum</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">left  -- -1 fork</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">right -- +1 fork</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">up    -- -1 clnum</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">down  -- +1 clnum</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">esc -- back</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">shift-c -- clear all forks</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">n -- rename instruction</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">shift-n -- rename data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">; -- add comment at instruction</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">shift-; -- add comment at data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">g -- go to change, address, or name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">space -- toggle flat/function view</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">p -- analyze function at iaddr</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">c -- make code at iaddr, one instruction</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">a -- make ascii at iaddr</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">d -- make data at iaddr</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">u -- make undefined at iaddr</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="further">Further<a href="#further" class="hash-link" aria-label="Direct link to Further" title="Direct link to Further">​</a></h2><p>qira is made of following compoments</p><ul><li>qemu</li><li>flask</li><li>python</li><li>qiradb</li></ul><p>qemu is used to emulate other architecture</p><p>Flask is a microframework for Python based on Werkzeug, Jinja 2 and good intentions</p><p>The most code of qira is written by Python</p><p>qiradb is a python package deal with the instruction trace</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="working-with-ida-plugin">Working with ida plugin<a href="#working-with-ida-plugin" class="hash-link" aria-label="Direct link to Working with ida plugin" title="Direct link to Working with ida plugin">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="testing-environment">Testing environment<a href="#testing-environment" class="hash-link" aria-label="Direct link to Testing environment" title="Direct link to Testing environment">​</a></h3><ul><li>Windows 10</li><li>Vmware workstation Pro 12 with Ubuntu 15.10</li></ul><p>Install qira 1.2 on Ubuntu 15.10 and port-forwarding 3002 port</p><p>Copy qira_ida66_windows.p64 and qira_ida66_windows.plw from qira/ida/bin/ to ida pro plugins/ directory</p><p>Open Chrome and IDA PRO on windows 10</p><p>It should work like this</p><p><img loading="lazy" src="http://qira.me/img/ida.png" alt="ida plugin" class="img_ev3q"></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/archives/tags/qira">qira</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/archives/tags/ctf">ctf</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/archives/useful-tools">useful tools</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2016-03-22T13:40:00.000Z" itemprop="datePublished">March 22, 2016</time> · <!-- -->2 min read</div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hackmd">hackmd<a href="#hackmd" class="hash-link" aria-label="Direct link to hackmd" title="Direct link to hackmd">​</a></h2><p><a href="https://hackmd.io/" target="_blank" rel="noopener noreferrer">https://hackmd.io/</a></p><p>還蠻推薦 hackmd 的</p><p>當初是看到 lab 的同學在用</p><p>他其中一個功能很好用就是上傳圖片</p><p>他會把圖片直接上傳到 <a href="http://imgur.com/" target="_blank" rel="noopener noreferrer">http://imgur.com/</a></p><p>再用 markdown 的寫法將圖片插入</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">![](圖片網址)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hackpad">hackpad<a href="#hackpad" class="hash-link" aria-label="Direct link to hackpad" title="Direct link to hackpad">​</a></h2><p><a href="https://hackpad.com/" target="_blank" rel="noopener noreferrer">https://hackpad.com/</a></p><p>這應該是最多人聽過支援 markdown 語法的協作平台</p><p>就不介紹了</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="stackeditor">stackeditor<a href="#stackeditor" class="hash-link" aria-label="Direct link to stackeditor" title="Direct link to stackeditor">​</a></h2><p><a href="https://stackedit.io/editor#" target="_blank" rel="noopener noreferrer">https://stackedit.io/editor#</a></p><p>線上的 markdown 編輯器</p><p>可以和 google drive 和 dropbox 使用</p><p>如果有再寫 google blogger 的可以用這個</p><p>stackeditor 寫完後就可以直接 publish 算是一個不錯的功能</p><p>缺點是沒有辦法和別人共同編輯</p><h1>Code Formatter</h1><ul><li>python: yapf</li></ul><p><a href="https://github.com/google/yapf" target="_blank" rel="noopener noreferrer">https://github.com/google/yapf</a></p><ul><li>C/C++: astyle</li></ul><p><a href="http://astyle.sourceforge.net/" target="_blank" rel="noopener noreferrer">http://astyle.sourceforge.net/</a></p><h1>CTF 相關</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="kali-linux">Kali Linux<a href="#kali-linux" class="hash-link" aria-label="Direct link to Kali Linux" title="Direct link to Kali Linux">​</a></h2><p><a href="https://www.kali.org/" target="_blank" rel="noopener noreferrer">https://www.kali.org/</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="gdb">gdb<a href="#gdb" class="hash-link" aria-label="Direct link to gdb" title="Direct link to gdb">​</a></h2><h2 class="anchor anchorWithStickyNavbar_LWe7" id="gdb-peda">gdb peda<a href="#gdb-peda" class="hash-link" aria-label="Direct link to gdb peda" title="Direct link to gdb peda">​</a></h2><p><a href="https://github.com/longld/peda" target="_blank" rel="noopener noreferrer">https://github.com/longld/peda</a></p><p>讓你的 gdb 介面變好看</p><p>還多的一些好用的 funtcion</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="qira">qira<a href="#qira" class="hash-link" aria-label="Direct link to qira" title="Direct link to qira">​</a></h2><h2 class="anchor anchorWithStickyNavbar_LWe7" id="strace">strace<a href="#strace" class="hash-link" aria-label="Direct link to strace" title="Direct link to strace">​</a></h2><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ltrace">ltrace<a href="#ltrace" class="hash-link" aria-label="Direct link to ltrace" title="Direct link to ltrace">​</a></h2><h2 class="anchor anchorWithStickyNavbar_LWe7" id="oda">ODA<a href="#oda" class="hash-link" aria-label="Direct link to ODA" title="Direct link to ODA">​</a></h2><p><a href="https://www.onlinedisassembler.com/odaweb/" target="_blank" rel="noopener noreferrer">https://www.onlinedisassembler.com/odaweb/</a></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/archives/tags/tool">tool</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/archives/symbolic-exection-introduction">symbolic exection introduction</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2016-02-23T09:19:00.000Z" itemprop="datePublished">February 23, 2016</time> · <!-- -->4 min read</div></header><div class="markdown" itemprop="articleBody"><hr><h1>Defenition</h1><p>Symbolic execution (also symbolic evaluation) is a means of analyzing a program to determine what inputs cause each part of a program to execute.</p><p>An interpreter follows the program, assuming symbolic values for inputs rather than obtaining actual inputs as normal execution of the program would, a case of abstract interpretation.</p><p>It thus arrives at expressions in terms of those symbols for expressions and variables in the program, and constraints in terms of those symbols for the possible outcomes of each conditional branch.</p><h1>Example</h1><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">int f() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  y = read();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  z = y * 2;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  if (z == 12) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    fail();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  } else {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    printf(&quot;OK&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>During &quot;concrete&quot; execution, the program would read a concrete input value (e.g., 5) and assign it to y.</p><p>During symbolic execution, the program reads a symbolic value (e.g., λ) and assigns it to y.</p><p>The program would then proceed with the multiplication and assign λ <em> 2 to z. When reaching the if statement, it would evaluate λ </em> 2 == 12.</p><p>At this point of the program, λ could take any value, and symbolic execution can therefore proceed along both branches, by &quot;forking&quot; two paths.</p><p>Each path get assigned a copy of the program state at the branch instruction as well as a path constraint.</p><p>When paths terminate (e.g., as a result of executing fail() or simply exiting), symbolic execution computes a concrete value for λ by solving the accumulated path constraints on each path.</p><h1>Limitations</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="path-explosion">Path Explosion<a href="#path-explosion" class="hash-link" aria-label="Direct link to Path Explosion" title="Direct link to Path Explosion">​</a></h2><p>Symbolically executing all feasible program paths does not scale to large programs.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="program-dependent-efficacy">Program-Dependent Efficacy<a href="#program-dependent-efficacy" class="hash-link" aria-label="Direct link to Program-Dependent Efficacy" title="Direct link to Program-Dependent Efficacy">​</a></h2><p>Symbolic execution is used to reason about a program path-by-path which is an advantage over reasoning about a program input-by-input as other testing paradigms use (e.g. Dynamic program analysis).</p><p>However, if few inputs take the same path through the program, there is little savings over testing each of the inputs separately.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="environment-interactions">Environment Interactions<a href="#environment-interactions" class="hash-link" aria-label="Direct link to Environment Interactions" title="Direct link to Environment Interactions">​</a></h2><p>Programs interact with their environment by performing system calls, receiving signals, etc.
Consistency problems may arise when execution reaches components that are not under control of the symbolic execution tool (e.g., kernel or libraries).</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">int main()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   FILE *fp = fopen(&quot;doc.txt&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   if (condition) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     fputs(&quot;some data&quot;, fp);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   } else {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">     fputs(&quot;some other data&quot;, fp);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   ...</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   data = fgets(..., fp);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"> }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This program opens a file and, based on some condition, writes different kind of data to the file. It then later reads back the written data. In theory, symbolic execution would fork two paths at line 5 and each path from there on would have its own copy of the file. The statement at line 11 would therefore return data that is consistent with the value of &quot;condition&quot; at line 5. In practice, file operations are implemented as system calls in the kernel, and are outside the control of the symbolic execution tool. The main approaches to address this challenge are:</p><p>Executing calls to the environment directly. The advantage of this approach is that it is simple to implement. The disadvantage is that the side effects of such calls will clobber all states managed by the symbolic execution engine. In the example above, the instruction at line 11 would return &quot;some datasome other data&quot; or &quot;some other datasomedata&quot; depending on the sequential ordering of the states.</p><p>Modeling the environment. In this case, the engine instruments the system calls with a model that simulates their effects and that keeps all the side effects in per-state storage. The advantage is that one would get correct results when symbolically executing programs that interact with the environment. The disadvantage is that one needs to implement and maintain many potentially complex models of system calls. Tools such as KLEE<!-- -->[<!-- -->5<!-- -->]<!-- --> and Cloud9 take this approach by implementing models for file system operations, sockets, IPC, etc.</p><p>Forking the entire system state. Symbolic execution tools based on virtual machines solve the environment problem by forking the entire VM state. For example, in S2E<!-- -->[<!-- -->6<!-- -->]<!-- --> each state is an independent VM snapshot that can be executed separately. This approach alleviates the need for writing and maintaining complex models and allows virtually any program binary to be executed symbolically. However, it has higher memory usage overheads (VM snapshots may be large).</p><h1>Tools</h1><table><thead><tr><th>Tool</th><th>It can analyze Arch/Lang</th><th>url</th></tr></thead><tbody><tr><td>KLEE</td><td>LLVM</td><td><a href="http://klee.github.io/" target="_blank" rel="noopener noreferrer">http://klee.github.io/</a></td></tr><tr><td>S2E</td><td>x86, x86-64, ARM / User and kernel-mode binaries</td><td><a href="http://s2e.epfl.ch" target="_blank" rel="noopener noreferrer">http://s2e.epfl.ch</a></td></tr><tr><td>Triton</td><td>x86 and x86-64</td><td><a href="http://triton.quarkslab.com" target="_blank" rel="noopener noreferrer">http://triton.quarkslab.com</a></td></tr><tr><td>angr</td><td>libVEX based</td><td><a href="http://angr.io/" target="_blank" rel="noopener noreferrer">http://angr.io/</a></td></tr></tbody></table><h1>Reference</h1><ul><li><a href="https://en.wikipedia.org/wiki/Symbolic_execution" target="_blank" rel="noopener noreferrer">https://en.wikipedia.org/wiki/Symbolic_execution</a></li><li><a href="http://www.tutorialspoint.com/software_testing_dictionary/symbolic_execution.htm" target="_blank" rel="noopener noreferrer">http://www.tutorialspoint.com/software_testing_dictionary/symbolic_execution.htm</a></li></ul></div><footer class="row docusaurus-mt-lg"></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/archives"><div class="pagination-nav__label">Newer Entries</div></a></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"></ul></div><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.slideshare.net/bananaappletw" target="_blank" rel="noopener noreferrer" class="footer__link-item">slideshare</a></li><li class="footer__item"><a href="https://stackoverflow.com/users/4446356/bananaappletw" target="_blank" rel="noopener noreferrer" class="footer__link-item">stackoverflow</a></li><li class="footer__item"><a href="https://twitter.com/bananaappletw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://www.linkedin.com/in/bananaappletw/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn</a></li><li class="footer__item"><a href="https://github.com/bananaappletw" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 bananaappletw, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.eacc079a.js"></script>
<script src="/assets/js/main.3611ed56.js"></script>
</body>
</html>